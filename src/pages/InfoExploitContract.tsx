import React, { useEffect, useState } from 'react';

import { useParams } from 'react-router-dom';
import MainLayout from '../layout/MainLayout';
import { IExploitContract } from '../types';
import { RightOutlined } from '@ant-design/icons';
import MenuActionContract from '../components/MenuActionContract';
import { getIExploitContractById } from '../redux/actions/exploitContractAction';
import FormInfoExploitContract from '../components/FormInfoExploitContract';

const InfoExploitContract: React.FC = () => {
    const [activeTab, setActiveTab] = useState<'info' | 'work'>('info');

    const { id } = useParams<{ id: string }>();
    const [contractData, setContractData] = useState<IExploitContract | null>(null);

    useEffect(() => {
        const fetchContractData = async () => {
            try {
                if (id) {
                    const data = await getIExploitContractById(id);
                    setContractData(data);
                }
            } catch (error) {
                console.error('Error fetching contract data:', error);
            }
        };
        fetchContractData();
    }, [id]);

  return (
    <MainLayout>
      <div style={{ marginLeft: '-120px' }}>
        {contractData && (
            <>
                <h3 style={{ color: 'gray', marginBottom: '-10px' }}>
                Quản lý <i><RightOutlined style={{ color: '#FFAC69' }} /></i> Quản lý hợp đồng <i><RightOutlined style={{ color: '#FFAC69' }} /></i> Chi tiết
                </h3>
                <h1>Hợp đồng khai thác - {contractData.number}</h1>

                <FormInfoExploitContract contract={[contractData]}></FormInfoExploitContract>

                <MenuActionContract 
                    activeTab={activeTab}
                    contractId={contractData?.id ?? ''} 
                    validity={typeof contractData?.validity === 'number' ? contractData.validity : undefined} 
                />          
            </>
        )}
      </div>
    </MainLayout>
  );
};

export default InfoExploitContract;
